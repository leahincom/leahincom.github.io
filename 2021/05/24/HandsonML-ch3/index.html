
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="leah">
    <title>3ì¥: ë¶„ë¥˜ - leah</title>
    <meta name="author" content="JungHyun">
    
        <meta name="keywords" content="hexo,javascript,">
    
    
    
    <script type="application/ld+json">{"@context":"http://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"JungHyun","sameAs":["https://github.com/leahincom","https://facebook.com/junghyun.lah/","https://www.linkedin.com/profile","mailto:leahincom@gmail.com"],"image":"profile.jpeg"},"articleBody":"3.1 MNISTsklearn.datasets : Toy datasetsë¥¼ ë‹´ì€ lib (í¬ê¸°ê°€ ì‘ì•„ í•™ìŠµìš©ì´ ì•„ë‹Œ ìƒ˜í”Œìš©ìœ¼ë¡œ ì‚¬ìš©)\nì¼ë°˜ì ì¸ êµ¬ì¡° â‡’ ì“¸ ìˆ˜ ìˆëŠ” keys :\n\në°ì´í„°ì…‹ì„ ì„¤ëª…í•˜ëŠ” DESCR í‚¤\nìƒ˜í”Œì´ í•˜ë‚˜ì˜ í–‰, íŠ¹ì„±ì´ í•˜ë‚˜ì˜ ì—´ë¡œ êµ¬ì„±ëœ ë°°ì—´ì„ ê°€ì§„ data í‚¤\në ˆì´ë¸” ë°°ì—´ì„ ë‹´ì€ target í‚¤\në“±ë“±\n\n\n\n\n\n1234from sklearn.datasets import fetch_openml mnist = fetch_openml(&#x27;mnist_784&#x27;, version=1) mnist.keys()  &gt;&gt;&gt; dict_keys([&#x27;data&#x27;, &#x27;target&#x27;, &#x27;feature_names&#x27;, &#x27;DESCR&#x27;, &#x27;details&#x27;, &#x27;categories&#x27;, &#x27;url&#x27;])\nìœ„ì˜ ê²°ê³¼ëŠ” mnistì˜ keyë“¤ë¡œ, dictionary êµ¬ì¡°ë¥¼ ê°€ì§„ mnistì— ëŒ€í•´ ì“¸ ìˆ˜ ìˆëŠ” ëª…ë ¹ë“¤ì„ ì˜ë¯¸í•œë‹¤.\n\n\n\n\n\n\ndata : í•™ìŠµìš©(feed) ë°ì´í„°\ntarget : label ë°ì´í„°ë¡œ, ë¶„ë¥˜ë  classë¥¼ ì˜ë¯¸\n\në”°ë¼ì„œ,\n12X, y = mnist[&quot;data&quot;], mnist[&quot;target&quot;] X.shape &gt;&gt;&gt; (70000, 784) # 784 = 28*28 y.shape &gt;&gt;&gt; (70000,)\nX.shapeëŠ” 70000ê°œì˜ dataì— ëŒ€í•´ ê° data ë‹¹ 28*28ì— í•´ë‹¹í•˜ëŠ” pixel ê°•ë„(0~255)ì„ ë‹´ê³  ìˆëŠ” ë°°ì—´ì„ ë‚˜íƒ€ë‚´ê³ ,\ny.shapeëŠ” 70000ê°œì˜ ë¶„ë¥˜ëœ classë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.\n\nmnistì˜ dataë¥¼ ë‹´ì€ X ë°°ì—´ì—ì„œ í•˜ë‚˜ì˜ ì´ë¯¸ì§€ë¥¼ ì˜ˆì‹œë¡œ ì¶”ì¶œí•˜ì—¬ ì¶œë ¥í•´ë³´ë„ë¡ í•œë‹¤.\n1some_digit = X[0] # 0ë²ˆì§¸ data some_digit_image = some_digit.reshape(28, 28) # 28*28 sizeì— ë§ê²Œ ë²¡í„° reshape\nsome_digit.reshape(28, 28)ì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ”, í˜„ì¬ [1, 784]ë¡œ ì €ì¥ë˜ì–´ ìˆëŠ” X[0]ì˜ ì´ë¯¸ì§€ ë²¡í„°ëŠ” [28,28]ì˜ ë°°ì—´ë¡œ reshapingí•œë‹¤ëŠ” ê²ƒì´ë‹¤.\n1y[0] &gt;&gt;&gt; &#x27;5&#x27;\nyì—ëŠ” ë¶„ë¥˜ëœ classê°€ ë‹´ê¸°ë¯€ë¡œ, X[0]ì€ â€˜5â€™ classì— ì†í•˜ëŠ” dataë¼ëŠ” ê²ƒì´ë‹¤.\nìœ„ì—ì„œ ì¶œë ¥ëœ ê²ƒì€ â€˜(ì‘ì€ë”°ì˜´í‘œ)â€™ë¡œë¶€í„° ì•Œ ìˆ˜ ìˆë“¯ì´ string dataì´ë¯€ë¡œ ì´ë¥¼ ì •ìˆ˜ë¡œ ë°”ê¾¸ëŠ” ì½”ë“œê°€ ë‹¤ìŒê³¼ ê°™ë‹¤.\n1y = y.astype(np.uint8)\n\n\n\n\n\n1ì¥ì—ì„œ ê³µë¶€í–ˆë“¯ì´, ìœ„ì˜ MNISTì€ ì§€ë„ í•™ìŠµ ëª¨ë¸ì´ë¯€ë¡œ,\në” ì¢‹ì€ training resultë¥¼ ë‚´ê¸° ìœ„í•´ì„œëŠ” í•˜ë‚˜ì˜ datasetì—ì„œ train datasetê³¼ test datasetì„ ì ì ˆíˆ ë‚˜ëˆ„ì–´ì•¼ í•œë‹¤. ë”°ë¼ì„œ í•´ë‹¹ MNISTì—ì„œëŠ” 6:1ë¡œ(ì „ì²´ 7ë§Œê°œì˜ dataset) train ë° test datasetì„ ë‚˜ëˆ„ì—ˆë‹¤.\në˜í•œ MNIST datasetì€ ë°ì´í„°ì…‹ì´ ì ì ˆíˆ ì„ì—¬ ìˆì–´, êµì°¨ ê²€ì¦ í´ë“œ(train / test set ê°„ ë¶„í¬ì˜ ê· ì§ˆì„±)ê°€ ë¹„ìŠ·í•˜ê³  í›ˆë ¨ ìƒ˜í”Œì˜ ìˆœì„œì— ë”°ë¥¸ ì„±ëŠ¥ ì €í•˜ë¥¼ ë°©ì§€í•œë‹¤.\n\n\n\n\n3.2 ì´ì§„ ë¶„ë¥˜ê¸° í›ˆë ¨ì´ì§„ ë¶„ë¥˜ê¸° : YES or NOë¡œ class ë¶„ë¥˜\n12y_train_5 = (y_train == 5)y_test_5 = (y_test == 5)\nìœ„ì˜ 2ê°€ì§€ ë³€ìˆ˜ëŠ” â€œê°ì§€ê¸°â€ ê·¸ ìì²´ì´ë‹¤. ì¦‰, ì˜¤ë¥¸ìª½ ì¡°ê±´ì´ Trueì¸ì§€ Falseì¸ì§€ íŒë‹¨í•˜ëŠ” ê°ì§€ê¸°ì˜ ì—­í• ì„ í•œë‹¤.\në¶„ë¥˜ ëª¨ë¸ë¡œ ì‚¬ìš©í•  SGD(Stochastic Gradient Descent) ë¶„ë¥˜ê¸°ëŠ” ì†ì‹¤í•¨ìˆ˜ ìì²´ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ì†ì‹¤í•¨ìˆ˜ì˜ ê¸°ëŒ“ê°’ì„ ìµœì†Œí™”í•˜ëŠ” ë°©ë²•ì„ ì´ìš©í•œë‹¤. ì¦‰, gradientê°€ ì•„ë‹Œ gradientì˜ ê¸°ëŒ“ê°’ì˜ ì¶”ì •ì¹˜ë¥¼ ì´ìš©í•œë‹¤. ì´ì— ì‚¬ìš©ë˜ëŠ” ìˆ˜ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. ğ‘¤(ğ‘˜+1)=ğ‘¤(ğ‘˜)+E[âˆ‡ğ¿]. ëª¨ë“  í•™ìŠµ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ minibatch(ì¼ë¶€ ë°ì´í„°, í•˜ë‚˜ì˜ í›ˆë ¨ ìƒ˜í”Œ ê·¸ë£¹)ë¥¼ ì´ìš©í•˜ì—¬ gradientì˜ ì¶”ì •ì¹˜ë¥¼ êµ¬í•˜ë¯€ë¡œ, gradientì˜ ê¸°ëŒ“ê°’ì˜ ì¶”ì •ì¹˜ëŠ” í‘œë³¸ í‰ê· ìœ¼ë¡œ ì‘ìš©í•œë‹¤. ë”°ë¼ì„œ ê³„ì‚°ëŸ‰ê³¼ í•™ìŠµ ë°ì´í„°ê°€ ë§ì€ deep learningê³¼ ì˜¨ë¼ì¸ í•™ìŠµ(ë¯¸ë‹ˆë°°ì¹˜ ì´ìš©)ì— ì í•©í•˜ë‹¤.\n1234from sklearn.linear_model import SGDClassifier sgd_clf = SGDClassifier(random_state=42) sgd_clf.fit(X_train, y_train_5) sgd_clf.predict([some_digit]) &gt;&gt;&gt; array([ True])\nSGDClassifier(random_state=42)ì—ì„œ random_stateì€ ë¬´ì‘ìœ„ ê°’ì„ ë„£ìœ¼ë©° ìµœì ê°’ì„ ì°¾ëŠ” SGDClassifierì˜ íŠ¹ì„±ì— ë”°ë¼, ì´ì „ì— ì‹¤í–‰í–ˆë˜ ê²°ê³¼ê°’ì„ repeatableí•˜ê²Œ ë°›ê¸° ìœ„í•´ íŠ¹ì •ê°’ì„ ì €ì¥í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ê°’ì˜ ì˜ë¯¸ëŠ” ë”±íˆ ì—†ìœ¼ë¯€ë¡œ, ì•„ë¬´ ì •ìˆ˜ë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ í›„ classifierì— dataì™€ y_train_5ë¥¼ ë„£ì–´ classifierì„ fittingí•œë‹¤.\nclassifierì€ predictì˜ ê²°ê³¼ë¡œ some_digit(=X[0])ì„ ë„£ì—ˆì„ ë•Œ y_train_5ì— ë”°ë¼ 5 ì—¬ë¶€ë¥¼ ê°ì§€í•œ ê²°ê³¼ë¥¼ arrayì— ë‹´ëŠ”ë‹¤.\n\n\n\n\n3.3 ì„±ëŠ¥ ì¸¡ì •3.3.1 êµì°¨ ê²€ì¦ì„ ì‚¬ìš©í•œ ì •í™•ë„ ì¸¡ì •1234567891011121314from sklearn.model_selection import StratifiedKFold from sklearn.base import clone skfolds = StratifiedKFold(n_splits=3, random_state=42) for train_index, test_index in skfolds.split(X_train, y_train_5) : \tclone_clf = clone(sgd_clf) \tX_train_folds = X_train[train_index] \ty_train_folds = y_train_5[train_index] \tX_test_fold = X_train[test_index] \ty_test_fold = y_train[test_index] clone_clf.fit(X_train_folds, y_train_folds) y_pred = clone_clf.predict(X_test_fold) n_correct = sum(y_pred == y_test_fold) print(n_correct / len(y_pred)) &gt;&gt;&gt; 0.9502, 0.96565, 0.96495\nStartifiedKFoldì—ì„œ n_splits=3ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ìœ¼ë¯€ë¡œ, í´ë“œê°€ 3ê°œì¸ k-ê²¹ êµì°¨ ê²€ì¦ì´ ìˆ˜í–‰ëœë‹¤.\ntrain/test_indexìœ¼ë¡œ skfolds ê°ì²´ì˜ split()ì„ í˜¸ì¶œí•˜ì—¬ í•™ìŠµìš©/ê²€ì¦ìš© ë°ì´í„°ë¡œ ë¶„í• í•  ìˆ˜ ìˆëŠ” ì¸ë±ìŠ¤ë¥¼ ë°˜í™˜ë°›ê³  ì‹¤ì œ ë¶„í• ëœ ë°ì´í„°ë¥¼ í•´ë‹¹ indexë¥¼ ëŒ€ì…í•˜ì—¬ ì¶”ì¶œí•œë‹¤. ì´ ë•Œ, split()ì˜ ëŒ€ìƒì€ X_train â†’ y_train_5 ì§‘í•©ì´ë‹¤. ì´ë¥¼ í† ëŒ€ë¡œ y ê°’ì˜ predictionì¸ y_predë¥¼ X_test_foldë¡œë¶€í„° predictí•˜ê³ , ì˜¬ë°”ë¥¸ ì˜ˆì¸¡ì˜ ìˆ˜ë¥¼ y_predì™€ y_test_foldë¥¼ ë¹„êµí•˜ì—¬ sum ê°’ì„ í†µí•´ ê³„ì‚°í•œë‹¤.\nìœ„ì˜ ê³¼ì •ì€ sklearnì˜ cross_val_scoreê³¼ ê±°ì˜ ê°™ì€ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¡œ ì •ë¦¬í•  ìˆ˜ ìˆë‹¤.\n12from sklearn.model_selection import cross_val_score cross_val_score(sgd_clf, X_train, y_train_5, cv=3, scoring=&quot;accuracy&quot;) &gt;&gt;&gt; array([0.96355, 0.93795, 0.95615])\nì´ëŠ” ì•½ 95%ë¡œ êµ‰ì¥íˆ ë†’ì€ ì •í™•ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. í•˜ì§€ë§Œ, ì´ëŸ¬í•œ ì •í™•ë„ë¥¼ ì„±ëŠ¥ ì¸¡ì • ì§€í‘œë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.\n\n\n\n\n\nìœ„ì˜ ì˜ˆì‹œì™€ ë°˜ëŒ€ë¡œ, 5ê°€ ì•„ë‹Œ í´ë˜ìŠ¤ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë”ë¯¸ ë¶„ë¥˜ê¸°ë¥¼ ë§Œë“¤ì–´ ì •í™•ë„ë¥¼ ë¹„êµí•´ë³¼ ìˆ˜ ìˆë‹¤.\n1234567891011from sklearn.base import BaseEstimator class Never5Classifier(BaseEstimator) : \tdef fit(self, X, y=None) : \t\treturn self \t\t\tdef predict(self, X) : \t\treturn np.zeros((len(X), 1), dtype=bool) never_5_clf = Never5Classifier() cross_val_score(never_5_clf, X_train, y_train_5, cv=3, scoring=&quot;accuracy&quot;) &gt;&gt;&gt; array([0.91125, 0.90855, 0.90915])\nì´ ë•Œ Never5Classifierì˜ predict í•¨ìˆ˜ëŠ” ë°°ì—´ì˜ ê²°ê³¼ë¥¼ ì „ë¶€ Falseë¡œ ì„¸íŒ…í•˜ì—¬ ë°°ì—´ì„ ë°˜í™˜í•œë‹¤.\ní•´ë‹¹ classifierì„ cross_val_scoreì— ì ìš©í•  ì‹œ ì •í™•ë„ê°€ 90% ê°€ëŸ‰ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ì•½ 10%ì˜ ì´ë¯¸ì§€ê°€ ìˆ«ì 5ì´ë¯€ë¡œ ì´ë¥¼ ì œì™¸í•œ 90%ë¥¼ ì •í™•ë„ë¡œ ì¶œë ¥í•œë‹¤. ë”°ë¼ì„œ, ë¶ˆê· í˜•í•œ ë°ì´í„°ì…‹(5ì„/5ê°€ ì•„ë‹˜ = ì–´ë–¤ í´ë˜ìŠ¤ê°€ ë‹¤ë¥¸ ê²ƒë³´ë‹¤ ì›”ë“±íˆ ë§ìŒ)ì„ ë‹¤ë£° ë•ŒëŠ” ì •í™•ë„ë¥¼ ë¶„ë¥˜ê¸°ì˜ ì„±ëŠ¥ ì¸¡ì • ì§€í‘œë¡œ ì„ í˜¸í•˜ì§€ ì•ŠëŠ”ë‹¤.\n\n\n\n\n3.3.2 ì˜¤ì°¨ í–‰ë ¬ì˜¤ì°¨ í–‰ë ¬ : ë°ì´í„°ì™€ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¡œ ì˜ëª» ë¶„ë¥˜í•œ íšŸìˆ˜ë¥¼ ë‹´ì€ í–‰ë ¬\n123from sklearn.model_selection import cross_val_predict y_train_pred = cross_val_predict(sgd_clf, X_train, y_train_5, cv=3)\ncross_val_score() : í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ outputì˜ í‰ê· ì„ ì´ìš©í•´ í‰ê°€ ì ìˆ˜ ë°˜í™˜\ncross_val_predict() : í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ inputì˜ ê° elementì— ëŒ€í•œ ê¹¨ë—í•œ ì˜ˆì¸¡ ë°˜í™˜ (í›ˆë ¨í•˜ëŠ” ë™ì•ˆ ì‚¬ìš©ë˜ì§€ ì•Šì€ ë°ì´í„°ì— ëŒ€í•´ ì˜ˆì¸¡)\n1confusion_matrix(y_train_5, y_train_pred) &gt;&gt;&gt; array([[53057, 1522], [1325, 4096]])\n\ní–‰ : ì‹¤ì œ í´ë˜ìŠ¤ (ë°ì´í„°)\nì—´ : ì˜ˆì¸¡í•œ í´ë˜ìŠ¤\n\në”°ë¼ì„œ, ìœ„ì˜ ê²°ê³¼ì—ì„œ ì²« ë²ˆì§¸ í–‰ì´ â€œ5 ì•„ë‹˜â€(ìŒì„± í´ë˜ìŠ¤)ì¼ ë•Œ, ì²« ë²ˆì§¸ ì—´ì€ True Negative(ì˜ˆì¸¡ N, ì‹¤ì œ N)ì„ ë‚˜íƒ€ë‚´ë©°, ë‘ ë²ˆì§¸ ì—´ì€ False Positive(ì˜ˆì¸¡ P, ì‹¤ì œ N)ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ë‘ ë²ˆì§¸ í–‰ì€ â€œ5ì„â€(ì–‘ì„± í´ë˜ìŠ¤)ì´ë©°, ì²« ë²ˆì§¸ ì—´ì€ FN(ì˜ˆì¸¡ N, ì‹¤ì œ P), ë‘ ë²ˆì§¸ ì—´ì€ TP(ì˜ˆì¸¡ P, ì‹¤ì œ P)ì´ë‹¤.\n\nì´ì— ì™„ë²½í•œ ë¶„ë¥˜ê¸°ëŠ” TPì™€ TNë§Œ ê°€ì§€ê³  ìˆì„ ê²ƒì´ë¯€ë¡œ, ì‹¤ì œ confusion matrixì˜ ì¶œë ¥ê°’ì€ ì£¼ëŒ€ê°ì„  ê°’ë§Œ ì¡´ì¬í•œë‹¤.\n1y_train_perfect_predictions = y_train_5 confusion_matrix(y_train_5, y_train_perfect_predictions) &gt;&gt;&gt; array([[54579, 0], [0, 5421]])\n\n\n\n\n3.3.3 ì •ë°€ë„ì™€ ì¬í˜„ìœ¨\nì •ë°€ë„ = ì •í™•ë„ = TP / (TP+FP)\nì¬í˜„ìœ¨ = ë¯¼ê°ë„ = TP / (TP+FN)\n\nì •ë°€ë„ëŠ” ì˜ˆì¸¡ì´ ì–‘ì„±ì¸ ê²°ê³¼(TP, FP)ë¥¼, ì¬í˜„ìœ¨ì€ ì‹¤ì œ ì–‘ì„±ì¸ ê²°ê³¼(TP,FN)ë¥¼ ì´ìš©í•œë‹¤.\nì¦‰, ì •ë°€ë„ëŠ” í™•ì‹¤í•œ ì–‘ì„± ìƒ˜í”Œ í•˜ë‚˜ë§Œ ì˜ˆì¸¡í•  ì‹œ 1ì´ ë‚˜ì˜¤ì§€ë§Œ ì´ëŠ” ë‹¤ë¥¸ ëª¨ë“  ì–‘ì„± ìƒ˜í”Œì„ ë¬´ì‹œí•œ ê²°ê³¼ì´ë¯€ë¡œ, ì¬í˜„ìœ¨(ë¯¼ê°ë„ ë˜ëŠ” ì§„ì§œ ì–‘ì„± ë¹„ìœ¨)ê³¼ ê°™ì€ ë‹¤ë¥¸ ì§€í‘œì™€ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ í•œë‹¤.\n12precision_score(y_train_5, y_train_pred) // ì •ë°€ë„ &gt;&gt;&gt; 0.729085... recall_score(y_train_5, y_train_pred) // ì¬í˜„ìœ¨ &gt;&gt;&gt; 0.755580...\n0.729ëŠ” ì •ë°€ë„ë¡œ, 5ë¡œ íŒë³„ëœ ì´ë¯¸ì§€ ì¤‘ 72.9%ê°€ ì •í™•í•˜ë‹¤ëŠ” ì˜ë¯¸ì´ë©°, 0.756ì€ ì¬í˜„ìœ¨ìœ¼ë¡œ, ì „ì²´ ìˆ«ì 5ì—ì„œ 75.6%ì˜ 5ë§Œ ê°ì§€í•œ ê²ƒì„ ì˜ë¯¸í•œë‹¤.\n\n\n\nì´ë¥¼ í•˜ë‚˜ì˜ ìˆ«ìë¡œ í†µí•©í•´ ì‚´í´ë³¼ ìˆ˜ ìˆëŠ” í‰ê°€ ì§€í‘œê°€ F1 ì ìˆ˜, ì¦‰ ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì˜ ì¡°í™” í‰ê· ì´ë‹¤.\n\nF1 = TP / (TP + (FN + FP) / 2)\n\n1f1_score(y_train_5, y_train_pred) &gt;&gt;&gt; 0.742096...\nì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì´ ë¹„ìŠ·í•  ì‹œ F1ì˜ ê°’ì´ ë†’ê²Œ ë‚˜ì˜¤ë¯€ë¡œ ê°„ë‹¨í•œ í‰ê°€ ì§€í‘œë¡œ ì´ìš©í•  ìˆ˜ ìˆì§€ë§Œ,\nì •ë°€ë„/ì¬í˜„ìœ¨ íŠ¸ë ˆì´ë“œì˜¤í”„ì— ë”°ë¼ ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì´ ë°˜ë¹„ë¡€í•˜ëŠ” ê²½ìš° ìƒí™©ì— ë”°ë¼ ë‘˜ì˜ ì¤‘ìš”ì„±ì´ ë‹¬ë¼ì§€ë¯€ë¡œ F1ì„ ì£¼ìš” í‰ê°€ ì§€í‘œë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•˜ì§€ ì•Šë‹¤.\n\n\n\n\n3.3.4 ì •ë°€ë„/ì¬í˜„ìœ¨ íŠ¸ë ˆì´ë“œì˜¤í”„ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì€ ê²°ì • í•¨ìˆ˜ì˜ ê²°ê³¼ë¡œ ë‚˜ì˜¨ output datasetì— ì ìš©í•˜ëŠ” ì„ê³—ê°’ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.\nì¦‰, ì„ê³—ê°’ì„ ë†’ê²Œ ì„¤ì •í•  ê²½ìš° ì •ë°€ë„ëŠ” ë†’ì•„ì§€ë‚˜ í¬í•¨ë˜ëŠ” TPê°€ ë‚®ì•„ì§€ë¯€ë¡œ ì¬í˜„ìœ¨ì€ ë–¨ì–´ì§€ë©°, ì„ê³—ê°’ì„ ë‚®ê²Œ ì„¤ì •í•  ê²½ìš° ì •ë°€ë„ëŠ” ë–¨ì–´ì§€ë‚˜ ì¬í˜„ìœ¨ì€ ë†’ì•„ì§„ë‹¤. some_digitì˜ ì˜ˆì¸¡ì— ì‚¬ìš©í•œ ì ìˆ˜ë¥¼ í™•ì¸í•˜ê³  ì„ê³—ê°’ì„ ì •í•´ ì–‘ì„±/ìŒì„± ì˜ˆì¸¡ì„ ë§Œë“¤ê¸° ìœ„í•´ decision_function()ì„ ì´ìš©í•œë‹¤.\n123456y_scores = sgd_clf.decision_function([some_digit]) y_scores &gt;&gt;&gt; array([2412.53175101]) threshold = 0 y_some_digit_pred = (y_scores &gt; threshold) &gt;&gt;&gt; array([ True]) threshold = 8000 y_some_digit_pred = (y_scores &gt; threshold) y_some_digit_[red &gt;&gt;&gt; array([False])\në”°ë¼ì„œ ì ì ˆí•œ ì„ê³—ê°’ì„ ì„¤ì •í•˜ê¸° ìœ„í•˜ì—¬, cross_val_predict()ì˜ decision_functionì„ ì´ìš©í•˜ì—¬ ëª¨ë“  ìƒ˜í”Œì˜ ê²°ì • ì ìˆ˜ë¥¼ ì–»ëŠ”ë‹¤. ì´í›„ precision_recall_curve()ë¥¼ ì´ìš©í•´ ê°€ëŠ¥í•œ ì„ê³—ê°’ì— ëŒ€í•œ ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì„ ì–»ëŠ”ë‹¤.\n12y_scores = cross_val_predict(sgd_clf, X_train, y_train_5, cv=3, method=&quot;decision_function&quot;) precisions, recalls, thresholds = precision_recall_curve(y_train_5, y_scores)\nì¢‹ì€ ì •ë°€ë„/ì¬í˜„ìœ¨ íŠ¸ë ˆì´ë“œì˜¤í”„ëŠ” ì¬í˜„ìœ¨ì— ëŒ€í•œ ì •ë°€ë„ ê³¡ì„ ì—ì„œ ì •ë°€ë„ê°€ ê¸‰ê²©í•˜ê²Œ ì¤„ì–´ë“œëŠ” ì§€ì  ì§ì „ì˜ ê°’ìœ¼ë¡œ ì„ê³—ê°’ì„ ì„¤ì •í•˜ë©´ ëœë‹¤.\në˜í•œ íŠ¹ì •í•œ ëª©í‘œì¹˜ì˜ ì •ë°€ë„ë¥¼ ë‹¬ì„±í•˜ëŠ” ê²ƒì´ ëª©í‘œ(n%ë¼ê³  ê°€ì •í•´ë³´ì.)ì¼ ë•ŒëŠ”, ë‹¤ìŒê³¼ ê°™ì´ ì„ê³—ê°’ì„ ì„¤ì •í•˜ë©´ ëœë‹¤.\n1234threshold_90_precision = thresholds[np.argmax(precisions &gt;= n / 100)] y_train_pred_90 = (y_scores &gt;= threshold_90_precision) precision_score(y_train_5, y_train_pred_90) &gt;&gt;&gt; 0.900038... recall_score(y_train_5, y_train_pred_90) &gt;&gt;&gt; 0.436819...\ní•˜ì§€ë§Œ ì¬í˜„ìœ¨ì´ ë„ˆë¬´ ë‚®ì„ ê²½ìš°, ë†’ì€ ì •ë°€ë„ì˜ ë¶„ë¥˜ê¸°ëŠ” ìœ ìš©í•˜ì§€ ì•Šë‹¤.\n\n\n\n\n3.3.5 ROC ê³¡ì„ ROC ê³¡ì„  : ê±°ì§“ ì–‘ì„± ë¹„ìœ¨(FPR)ì— ëŒ€í•œ ì§„ì§œ ì–‘ì„± ë¹„ìœ¨(TPR, ì¬í˜„ìœ¨)ì˜ ê³¡ì„ ìœ¼ë¡œ, FPR = 1(ì‹¤ì œ ìŒì„±) - TNRì´ë‹¤. ì´ ë•Œ TNRì„ íŠ¹ì´ë„ë¼ê³  í•˜ë©°, ROCë¥¼ ì¬í˜„ìœ¨ì— ëŒ€í•œ 1-íŠ¹ì´ë„ë¼ê³  í•œë‹¤.\nTPRê³¼ FPRì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜ëŠ” roc_curve()ë¡œ, ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©ëœë‹¤.\n1fpr, tpr, thresholds = roc_curve(y_train_5, y_scores)\nTPRì´ ë†’ì•„ì§ˆ ìˆ˜ë¡ FPRë„ ë†’ì•„ì§€ë¯€ë¡œ, ì¢‹ì€ ë¶„ë¥˜ê¸°ëŠ” ì™„ì „í•œ ëœë¤ ë¶„ë¥˜ê¸°(TPR : FPR = 1 : 1)ì—ì„œ ìµœëŒ€í•œ ì™¼ìª½ ìœ„ ëª¨ì„œë¦¬(TPRì€ ë†’ê³  FPRì€ ë‚®ì€)ë¡œ ë©€ë¦¬ ë–¨ì–´ì ¸ì•¼ í•œë‹¤. ì´ë¥¼ í‰ê°€í•˜ëŠ” ì§€í‘œë¡œëŠ” ê³¡ì„  ì•„ë˜ì˜ ë©´ì (AUC)ê°€ ìˆëŠ”ë°, AUCë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ RandomForestClassifierì„ ì´ìš©í•œë‹¤.\n12345from sklearn.ensemble import RandomForestClassifier forest_clf = RandomForestClassifier(random_state = 42) y_probas_forest = cross_val_predict(forest_clf, X_train, y_train_5, cv=3, method=&quot;predict_proba&quot;) y_scores_forest = y_probas_forest[:, 1] roc_auc_score(y_train_5, y_scores_forest)\nRandomForestClassifierì—ì„œëŠ” decision_function ëŒ€ì‹  predict_proba ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.\nê·¸ ê²°ê³¼ë¡œì„œ, RandomForestClassifierëŠ” SGDClassifierë³´ë‹¤ ì™¼ìª½ ìœ„ ëª¨ì„œë¦¬ì— ë” ê°€ê¹Œìš´ ROC ê³¡ì„ ì„ ìƒì„±í•˜ë¯€ë¡œ AUC ì ìˆ˜ë¡œ ë” ë†’ë‹¤.\n\n\n\n\n3.4 ë‹¤ì¤‘ ë¶„ë¥˜ë‹¤ì¤‘ ë¶„ë¥˜ê¸°ë¡œ ë‘˜ ì´ìƒì˜ í´ë˜ìŠ¤ë¥¼ êµ¬ë³„í•  ìˆ˜ ìˆìœ¼ë‚˜, ë³´í†µ ì´ì§„ ë¶„ë¥˜ê¸°ë¥¼ ì´ìš©í•´ ë‹¤ìŒê³¼ ê°™ì€ 2ê°€ì§€ì˜ ë°©ë²•ìœ¼ë¡œ ë‹¤ì¤‘ í´ë˜ìŠ¤ë¥¼ êµ¬ë³„í•œë‹¤. ë³´í†µ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ ì‘ì—…ì— ì´ì§„ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì„ ì„ íƒí•˜ë©´ ìë™ì ìœ¼ë¡œ OvRì´ë‚˜ OvOë¥¼ ì‹¤í–‰í•˜ì§€ë§Œ, importë¥¼ í†µí•´ í´ë˜ìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ê°•ì œì ìœ¼ë¡œ ì›í•˜ëŠ” Classifierì„ ì„¤ì •í•  ìˆ˜ë„ ìˆë‹¤.\n\nOvR(OvA) : íŠ¹ì • í´ë˜ìŠ¤ë§Œ êµ¬ë¶„í•˜ëŠ” í´ë˜ìŠ¤ë³„ ì´ì§„ ë¶„ë¥˜ê¸° nê°œë¥¼ í›ˆë ¨ì‹œì¼œ í´ë˜ìŠ¤ê°€ nê°œì˜ í´ë˜ìŠ¤ ë¶„ë¥˜ ì‹œìŠ¤í…œì„ ë§Œë“ ë‹¤. ì´í›„ ê° ë¶„ë¥˜ê¸°ì˜ ê²°ì • ì ìˆ˜ ì¤‘ì—ì„œ ê°€ì¥ ë†’ì€ ê²ƒì„ í´ë˜ìŠ¤ë¡œ ì„ íƒí•œë‹¤. ì´ëŠ” í° í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ì ì€ ë¶„ë¥˜ê¸°ë¥¼ í›ˆë ¨ì‹œí‚¨ë‹¤.\n\n1from sklearn.multiclass import OneVsRestClassifier\n\nOvO : ê° í´ë˜ìŠ¤ì˜ ì¡°í•©ë§ˆë‹¤ ì´ì§„ ë¶„ë¥˜ê¸°ë¥¼ í›ˆë ¨ì‹œí‚¨ë‹¤. ì´ ì¤‘ ê°€ì¥ ë§ì´ ì–‘ì„±ìœ¼ë¡œ ë¶„ë¥˜ëœ í´ë˜ìŠ¤ë¥¼ ì„ íƒí•œë‹¤. ì´ëŠ” ê° ë¶„ë¥˜ê¸°ì˜ í›ˆë ¨ì— ì „ì²´ í›ˆë ¨ ì„¸íŠ¸ ì¤‘ êµ¬ë³„í•  ë‘ í´ë˜ìŠ¤ì˜ ìƒ˜í”Œë§Œ í•„ìš”í•˜ë¯€ë¡œ, ì‘ì€ í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ë§ì€ ë¶„ë¥˜ê¸°ë¥¼ í›ˆë ¨ì‹œí‚¬ ìˆ˜ ìˆë‹¤.\n\n1from sklearn.multiclass import OneVsOneClassifier\në” ë†’ì€ ì •í™•ë„ë¥¼ ìœ„í•´, ì…ë ¥ì˜ ìŠ¤ì¼€ì¼ì„ ì¡°ì •í•˜ë©´ ë¶„ë¥˜ê¸°ì˜ ì„±ëŠ¥ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.\n123from sklearn.preprocessing import StandartScaler scaler = StandardScaler() X_train_scaled = scaler.fit_transform(X_train.astype(float64))\n\n\n\n\n3.5 ì—ëŸ¬ ë¶„ì„cross_val_predict()ë¥¼ ì´ìš©í•´ ê²°ê³¼ê°’ì„ ì˜ˆì¸¡í•˜ê³ , ì´ í›„ confusion_matrix()ë¥¼ ì´ìš©í•´ ì˜¤ì°¨ í–‰ë ¬ì„ ìƒì„±í•œë‹¤. ê·¸ í›„ matshow()ë¥¼ ì‹¤í–‰ ì‹œ, ê° í´ë˜ìŠ¤ ë³„ë¡œ ì˜ˆì¸¡í•œ í´ë˜ìŠ¤ì˜ í™•ë¥ ì´ ë°ê¸°ë¡œ ë‚˜íƒ€ë‚˜ëŠ”ë°, ë°ì„ ìˆ˜ë¡ ë†’ì€ í™•ë¥ ì„ ë‚˜íƒ€ë‚¸ë‹¤. ë”°ë¼ì„œ ì˜¬ë°”ë¥¸ ì˜¤ì°¨ í–‰ë ¬ì€ ì£¼ëŒ€ê°ì„ ì˜ ë°ê¸°ê°€ ë°ê³ , ë‚˜ë¨¸ì§€ëŠ” ì–´ë‘ì›Œì•¼ í•œë‹¤.\nì´ëŸ¬í•œ ì˜¤ì°¨ í–‰ë ¬ì˜ íŠ¹ì„±ì— ë”°ë¼ ì˜ëª» ë¶„ë¥˜ëœ í´ë˜ìŠ¤ë¥¼ íŒŒì•…í•˜ê³  ë¶„ë¥˜ê¸°ì˜ ì„±ëŠ¥ í–¥ìƒ ë°©ì•ˆì— ëŒ€í•´ ìƒê°í•´ë³¼ ìˆ˜ ìˆë‹¤. íŠ¹íˆ ì´ ê³¼ì •ì—ì„œ ë°ì´í„°ì˜ ì „ì²˜ë¦¬ê°€ ì¤‘ìš”í•œë°, 3ê³¼ 5ì˜ í´ë˜ìŠ¤ë¥¼ ë¶„ë¥˜í•˜ëŠ” ì˜ˆì‹œì˜ ê²½ìš° SGDClassifierì„ ì ìš©í•  ê²½ìš° ë¯¸ì„¸í•œ í”½ì…€ ê°•ë„ì˜ ì°¨ì´ê°€ í´ë˜ìŠ¤ ë¶„ë¥˜ì˜ ì˜¤ë¥˜ë¡œ ì´ì–´ì§€ë¯€ë¡œ ì´ë¯¸ì§€ì˜ íšŒì „ê°’ì„ 0ìœ¼ë¡œ ì¡°ì •í•˜ëŠ” ê²ƒì´ ì´ì— í•´ë‹¹í•œë‹¤.\n\n\n\n\n3.6 ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜ ì‹œìŠ¤í…œ : í•˜ë‚˜ì˜ ìƒ˜í”Œì— ì—¬ëŸ¬ ê°œì˜ í´ë˜ìŠ¤ê°€ í¬í•¨ë  ê²½ìš°, ë ˆì´ë¸”ì„ ë‹¬ì•„ ê° í´ë˜ìŠ¤ë¥¼ êµ¬ë³„í•˜ëŠ” ì‹œìŠ¤í…œ\në‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜ ì‹œ ì ì ˆí•œ ì§€í‘œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•œë°, ë‹¤ìŒê³¼ ê°™ì´ F1 ì ìˆ˜ì— ë‹¤ë¥¸ ê°€ì¤‘ì¹˜ ê¸°ì¤€ì„ ì ìš©í•˜ì—¬ ë¶„ë¥˜ê¸°ë¥¼ í‰ê°€í•  ìˆ˜ ìˆë‹¤.\n123y_train_knn_pred = cross_val_predict(knn_clf, X_train, y_multilabel, cv=3) f1_score(y_multilabel, y_train_knn_pred, average = &quot;macro&quot;) # ëª¨ë“  ë ˆì´ë¸”ì˜ ê°€ì¤‘ì¹˜ê°€ ê°™ìŒ f1_score(y_multilabel, y_train_knn_pred, average = &quot;weighted&quot;) # íƒ€ê¹ƒ ë ˆì´ë¸”ì— ì†í•œ ìƒ˜í”Œ ìˆ˜(ì§€ì§€ë„)ì— ê°€ì¤‘ì¹˜ë¥¼ ë‘ \n\n\n\n\n3.7 ë‹¤ì¤‘ ì¶œë ¥ ë¶„ë¥˜ë‹¤ì¤‘ ì¶œë ¥ ë¶„ë¥˜(ë‹¤ì¤‘ ì¶œë ¥ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜) ì‹œìŠ¤í…œ : ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜ì—ì„œ ê° ë ˆì´ë¸”ì´ ë‹¤ì¤‘ í´ë˜ìŠ¤ê°€ ë  ìˆ˜ ìˆë„ë¡ ì¼ë°˜í™”í•œ ì‹œìŠ¤í…œ\nì´ë¥¼ ì¡ìŒì´ í¬í•¨ëœ ì´ë¯¸ì§€ë¥¼ ì˜ˆì‹œë¡œ ì„¤ëª…í•´ë³´ìë©´, ì¡ìŒì´ í¬í•¨ëœ ì´ë¯¸ì§€ì˜ ê° í”½ì…€ì€ í•˜ë‚˜ì˜ ë ˆì´ë¸”ì— í•´ë‹¹ë˜ë©° ëª¨ë“  í”½ì…€ì€ 0~255ì˜ ë‹¤ì–‘í•œ ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. í•´ë‹¹ ì´ë¯¸ì§€ì—ì„œ ì¡ìŒì„ ì œê±° ì‹œ ê° í”½ì…€ì˜ ê°’ì€ ë³€í™”í•˜ë¯€ë¡œ ë‹¤ì¤‘ í´ë˜ìŠ¤ê°€ ë  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ì´ëŠ” ë‹¤ì¤‘ ë ˆì´ë¸”ì— ë‹¤ì¤‘ í´ë˜ìŠ¤ê°€ í•©ì³ì§„ ë‹¤ì¤‘ ì¶œë ¥ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ì´ë‹¤.\n","dateCreated":"2021-05-24T23:24:28+09:00","dateModified":"2021-05-24T15:36:43+09:00","datePublished":"2021-05-24T23:24:28+09:00","description":"","headline":"3ì¥: ë¶„ë¥˜","image":[],"mainEntityOfPage":{"@type":"WebPage","@id":"https://leahincom.github.io/2021/05/24/HandsonML-ch3/"},"publisher":{"@type":"Organization","name":"JungHyun","sameAs":["https://github.com/leahincom","https://facebook.com/junghyun.lah/","https://www.linkedin.com/profile","mailto:leahincom@gmail.com"],"image":"profile.jpeg","logo":{"@type":"ImageObject","url":"profile.jpeg"}},"url":"https://leahincom.github.io/2021/05/24/HandsonML-ch3/","keywords":"machine learning, Hands-On Machine Learning, Keras, Tensorflow"}</script>
    <meta name="description" content="3.1 MNISTsklearn.datasets : Toy datasetsë¥¼ ë‹´ì€ lib (í¬ê¸°ê°€ ì‘ì•„ í•™ìŠµìš©ì´ ì•„ë‹Œ ìƒ˜í”Œìš©ìœ¼ë¡œ ì‚¬ìš©) ì¼ë°˜ì ì¸ êµ¬ì¡° â‡’ ì“¸ ìˆ˜ ìˆëŠ” keys :  ë°ì´í„°ì…‹ì„ ì„¤ëª…í•˜ëŠ” DESCR í‚¤ ìƒ˜í”Œì´ í•˜ë‚˜ì˜ í–‰, íŠ¹ì„±ì´ í•˜ë‚˜ì˜ ì—´ë¡œ êµ¬ì„±ëœ ë°°ì—´ì„ ê°€ì§„ data í‚¤ ë ˆì´ë¸” ë°°ì—´ì„ ë‹´ì€ target í‚¤ ë“±ë“±      1234from skle">
<meta property="og:type" content="blog">
<meta property="og:title" content="3ì¥: ë¶„ë¥˜">
<meta property="og:url" content="https://leahincom.github.io/2021/05/24/HandsonML-ch3/index.html">
<meta property="og:site_name" content="leah">
<meta property="og:description" content="3.1 MNISTsklearn.datasets : Toy datasetsë¥¼ ë‹´ì€ lib (í¬ê¸°ê°€ ì‘ì•„ í•™ìŠµìš©ì´ ì•„ë‹Œ ìƒ˜í”Œìš©ìœ¼ë¡œ ì‚¬ìš©) ì¼ë°˜ì ì¸ êµ¬ì¡° â‡’ ì“¸ ìˆ˜ ìˆëŠ” keys :  ë°ì´í„°ì…‹ì„ ì„¤ëª…í•˜ëŠ” DESCR í‚¤ ìƒ˜í”Œì´ í•˜ë‚˜ì˜ í–‰, íŠ¹ì„±ì´ í•˜ë‚˜ì˜ ì—´ë¡œ êµ¬ì„±ëœ ë°°ì—´ì„ ê°€ì§„ data í‚¤ ë ˆì´ë¸” ë°°ì—´ì„ ë‹´ì€ target í‚¤ ë“±ë“±      1234from skle">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2021-05-24T14:24:28.000Z">
<meta property="article:modified_time" content="2021-05-24T06:36:43.234Z">
<meta property="article:author" content="JungHyun">
<meta property="article:tag" content="machine learning">
<meta property="article:tag" content="Hands-On Machine Learning">
<meta property="article:tag" content="Keras">
<meta property="article:tag" content="Tensorflow">
<meta name="twitter:card" content="summary">
    
    
        
    
    
        <meta property="og:image" content="https://leahincom.github.io/assets/images/profile.jpeg"/>
    
    
    
    
    <!--STYLES-->
    
<link rel="stylesheet" href="/assets/css/all.css">

    
<link rel="stylesheet" href="/assets/css/jquery.fancybox.css">

    
<link rel="stylesheet" href="/assets/css/thumbs.css">

    
<link rel="stylesheet" href="/assets/css/tranquilpeak.css">

    <!--STYLES END-->
    

    

    
        
    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="5">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a
            class="header-title-link"
            href="/"
            aria-label=""
        >
            leah
        </a>
    </div>
    
        
            <a
                class="header-right-picture "
                href="#about"
                aria-label="Open the link: /#about"
            >
        
        
            <img class="header-picture" src="/assets/images/profile.jpeg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="5">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a
                    href="/#about"
                    aria-label="Read more about the author"
                >
                    <img class="sidebar-profile-picture" src="/assets/images/profile.jpeg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">JungHyun</h4>
                
                    <h5 class="sidebar-profile-bio"><p>author.bio</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/"
                            
                            rel="noopener"
                            title="Home"
                        >
                        <i class="sidebar-button-icon fa fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-categories"
                            
                            rel="noopener"
                            title="Categories"
                        >
                        <i class="sidebar-button-icon fa fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-tags"
                            
                            rel="noopener"
                            title="Tags"
                        >
                        <i class="sidebar-button-icon fa fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/all-archives"
                            
                            rel="noopener"
                            title="Archives"
                        >
                        <i class="sidebar-button-icon fa fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link open-algolia-search"
                            href="#search"
                            
                            rel="noopener"
                            title="Search"
                        >
                        <i class="sidebar-button-icon fa fa-search" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Search</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="#about"
                            
                            rel="noopener"
                            title="About"
                        >
                        <i class="sidebar-button-icon fa fa-question" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">About</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://github.com/leahincom"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="GitHub"
                        >
                        <i class="sidebar-button-icon fab fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://facebook.com/junghyun.lah/"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Facebook"
                        >
                        <i class="sidebar-button-icon fab fa-facebook" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Facebook</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="https://www.linkedin.com/profile"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="LinkedIn"
                        >
                        <i class="sidebar-button-icon fab fa-linkedin" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">LinkedIn</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="mailto:leahincom@gmail.com"
                            
                                target="_blank"
                            
                            rel="noopener"
                            title="Mail"
                        >
                        <i class="sidebar-button-icon fa fa-envelope" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Mail</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a
                            class="sidebar-button-link "
                            href="/atom.xml"
                            
                            rel="noopener"
                            title="RSS"
                        >
                        <i class="sidebar-button-icon fa fa-rss" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">RSS</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="5"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title">
            3ì¥: ë¶„ë¥˜
        </h1>
    
    
        <div class="post-meta">
    <time datetime="2021-05-24T23:24:28+09:00">
	
		    May 24, 2021
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/ML/">ML</a>, <a class="category-link" href="/categories/ML/Hands-On/">Hands-On</a>


    
</div>

    
</div>

    
    <div class="post-content markdown">
        <div class="main-content-wrap">
            <h2 id="3-1-MNIST"><a href="#3-1-MNIST" class="headerlink" title="3.1 MNIST"></a>3.1 MNIST</h2><p>sklearn.datasets : Toy datasetsë¥¼ ë‹´ì€ lib (í¬ê¸°ê°€ ì‘ì•„ í•™ìŠµìš©ì´ ì•„ë‹Œ ìƒ˜í”Œìš©ìœ¼ë¡œ ì‚¬ìš©)</p>
<p>ì¼ë°˜ì ì¸ êµ¬ì¡° â‡’ ì“¸ ìˆ˜ ìˆëŠ” keys :</p>
<ul>
<li>ë°ì´í„°ì…‹ì„ ì„¤ëª…í•˜ëŠ” DESCR í‚¤</li>
<li>ìƒ˜í”Œì´ í•˜ë‚˜ì˜ í–‰, íŠ¹ì„±ì´ í•˜ë‚˜ì˜ ì—´ë¡œ êµ¬ì„±ëœ ë°°ì—´ì„ ê°€ì§„ data í‚¤</li>
<li>ë ˆì´ë¸” ë°°ì—´ì„ ë‹´ì€ target í‚¤</li>
<li>ë“±ë“±</li>
</ul>
<br />



<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.datasets </span><br><span class="line"><span class="keyword">import</span> fetch_openml </span><br><span class="line">mnist = fetch_openml(<span class="string">&#x27;mnist_784&#x27;</span>, version=<span class="number">1</span>) </span><br><span class="line">mnist.keys()  &gt;&gt;&gt; dict_keys([<span class="string">&#x27;data&#x27;</span>, <span class="string">&#x27;target&#x27;</span>, <span class="string">&#x27;feature_names&#x27;</span>, <span class="string">&#x27;DESCR&#x27;</span>, <span class="string">&#x27;details&#x27;</span>, <span class="string">&#x27;categories&#x27;</span>, <span class="string">&#x27;url&#x27;</span>])</span><br></pre></td></tr></table></figure>
<p>ìœ„ì˜ ê²°ê³¼ëŠ” mnistì˜ keyë“¤ë¡œ, dictionary êµ¬ì¡°ë¥¼ ê°€ì§„ mnistì— ëŒ€í•´ ì“¸ ìˆ˜ ìˆëŠ” ëª…ë ¹ë“¤ì„ ì˜ë¯¸í•œë‹¤.</p>
<br />



<hr>
<ol>
<li>data : í•™ìŠµìš©(feed) ë°ì´í„°</li>
<li>target : label ë°ì´í„°ë¡œ, ë¶„ë¥˜ë  classë¥¼ ì˜ë¯¸</li>
</ol>
<p>ë”°ë¼ì„œ,</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">X, y = mnist[<span class="string">&quot;data&quot;</span>], mnist[<span class="string">&quot;target&quot;</span>] </span><br><span class="line">X.shape &gt;&gt;&gt; (<span class="number">70000</span>, <span class="number">784</span>) <span class="comment"># 784 = 28*28 y.shape &gt;&gt;&gt; (70000,)</span></span><br></pre></td></tr></table></figure>
<p>X.shapeëŠ” 70000ê°œì˜ dataì— ëŒ€í•´ ê° data ë‹¹ 28*28ì— í•´ë‹¹í•˜ëŠ” pixel ê°•ë„(0~255)ì„ ë‹´ê³  ìˆëŠ” ë°°ì—´ì„ ë‚˜íƒ€ë‚´ê³ ,</p>
<p>y.shapeëŠ” 70000ê°œì˜ ë¶„ë¥˜ëœ classë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.</p>
<hr>
<p>mnistì˜ dataë¥¼ ë‹´ì€ X ë°°ì—´ì—ì„œ í•˜ë‚˜ì˜ ì´ë¯¸ì§€ë¥¼ ì˜ˆì‹œë¡œ ì¶”ì¶œí•˜ì—¬ ì¶œë ¥í•´ë³´ë„ë¡ í•œë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">some_digit = X[<span class="number">0</span>] <span class="comment"># 0ë²ˆì§¸ data some_digit_image = some_digit.reshape(28, 28) # 28*28 sizeì— ë§ê²Œ ë²¡í„° reshape</span></span><br></pre></td></tr></table></figure>
<p>some_digit.reshape(28, 28)ì´ ì˜ë¯¸í•˜ëŠ” ë°”ëŠ”, í˜„ì¬ [1, 784]ë¡œ ì €ì¥ë˜ì–´ ìˆëŠ” X[0]ì˜ ì´ë¯¸ì§€ ë²¡í„°ëŠ” [28,28]ì˜ ë°°ì—´ë¡œ reshapingí•œë‹¤ëŠ” ê²ƒì´ë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y[<span class="number">0</span>] &gt;&gt;&gt; <span class="string">&#x27;5&#x27;</span></span><br></pre></td></tr></table></figure>
<p>yì—ëŠ” ë¶„ë¥˜ëœ classê°€ ë‹´ê¸°ë¯€ë¡œ, X[0]ì€ â€˜5â€™ classì— ì†í•˜ëŠ” dataë¼ëŠ” ê²ƒì´ë‹¤.</p>
<p>ìœ„ì—ì„œ ì¶œë ¥ëœ ê²ƒì€ â€˜(ì‘ì€ë”°ì˜´í‘œ)â€™ë¡œë¶€í„° ì•Œ ìˆ˜ ìˆë“¯ì´ string dataì´ë¯€ë¡œ ì´ë¥¼ ì •ìˆ˜ë¡œ ë°”ê¾¸ëŠ” ì½”ë“œê°€ ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y = y.astype(np.uint8)</span><br></pre></td></tr></table></figure>
<hr>
<br />



<p>1ì¥ì—ì„œ ê³µë¶€í–ˆë“¯ì´, ìœ„ì˜ MNISTì€ ì§€ë„ í•™ìŠµ ëª¨ë¸ì´ë¯€ë¡œ,</p>
<p>ë” ì¢‹ì€ training resultë¥¼ ë‚´ê¸° ìœ„í•´ì„œëŠ” í•˜ë‚˜ì˜ datasetì—ì„œ train datasetê³¼ test datasetì„ ì ì ˆíˆ ë‚˜ëˆ„ì–´ì•¼ í•œë‹¤. ë”°ë¼ì„œ í•´ë‹¹ MNISTì—ì„œëŠ” 6:1ë¡œ(ì „ì²´ 7ë§Œê°œì˜ dataset) train ë° test datasetì„ ë‚˜ëˆ„ì—ˆë‹¤.</p>
<p>ë˜í•œ MNIST datasetì€ ë°ì´í„°ì…‹ì´ ì ì ˆíˆ ì„ì—¬ ìˆì–´, êµì°¨ ê²€ì¦ í´ë“œ(train / test set ê°„ ë¶„í¬ì˜ ê· ì§ˆì„±)ê°€ ë¹„ìŠ·í•˜ê³  í›ˆë ¨ ìƒ˜í”Œì˜ ìˆœì„œì— ë”°ë¥¸ ì„±ëŠ¥ ì €í•˜ë¥¼ ë°©ì§€í•œë‹¤.</p>
<br />



<h2 id="3-2-ì´ì§„-ë¶„ë¥˜ê¸°-í›ˆë ¨"><a href="#3-2-ì´ì§„-ë¶„ë¥˜ê¸°-í›ˆë ¨" class="headerlink" title="3.2 ì´ì§„ ë¶„ë¥˜ê¸° í›ˆë ¨"></a>3.2 ì´ì§„ ë¶„ë¥˜ê¸° í›ˆë ¨</h2><p>ì´ì§„ ë¶„ë¥˜ê¸° : YES or NOë¡œ class ë¶„ë¥˜</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_train_5 = (y_train == <span class="number">5</span>)</span><br><span class="line">y_test_5 = (y_test == <span class="number">5</span>)</span><br></pre></td></tr></table></figure>
<p>ìœ„ì˜ 2ê°€ì§€ ë³€ìˆ˜ëŠ” â€œê°ì§€ê¸°â€ ê·¸ ìì²´ì´ë‹¤. ì¦‰, ì˜¤ë¥¸ìª½ ì¡°ê±´ì´ Trueì¸ì§€ Falseì¸ì§€ íŒë‹¨í•˜ëŠ” ê°ì§€ê¸°ì˜ ì—­í• ì„ í•œë‹¤.</p>
<p>ë¶„ë¥˜ ëª¨ë¸ë¡œ ì‚¬ìš©í•  SGD(Stochastic Gradient Descent) ë¶„ë¥˜ê¸°ëŠ” ì†ì‹¤í•¨ìˆ˜ ìì²´ë¥¼ ìµœì†Œí™”í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, ì†ì‹¤í•¨ìˆ˜ì˜ ê¸°ëŒ“ê°’ì„ ìµœì†Œí™”í•˜ëŠ” ë°©ë²•ì„ ì´ìš©í•œë‹¤. ì¦‰, gradientê°€ ì•„ë‹Œ gradientì˜ ê¸°ëŒ“ê°’ì˜ ì¶”ì •ì¹˜ë¥¼ ì´ìš©í•œë‹¤. ì´ì— ì‚¬ìš©ë˜ëŠ” ìˆ˜ì‹ì€ ë‹¤ìŒê³¼ ê°™ë‹¤. ğ‘¤(ğ‘˜+1)=ğ‘¤(ğ‘˜)+E[âˆ‡ğ¿]. ëª¨ë“  í•™ìŠµ ë°ì´í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ minibatch(ì¼ë¶€ ë°ì´í„°, í•˜ë‚˜ì˜ í›ˆë ¨ ìƒ˜í”Œ ê·¸ë£¹)ë¥¼ ì´ìš©í•˜ì—¬ gradientì˜ ì¶”ì •ì¹˜ë¥¼ êµ¬í•˜ë¯€ë¡œ, gradientì˜ ê¸°ëŒ“ê°’ì˜ ì¶”ì •ì¹˜ëŠ” í‘œë³¸ í‰ê· ìœ¼ë¡œ ì‘ìš©í•œë‹¤. ë”°ë¼ì„œ ê³„ì‚°ëŸ‰ê³¼ í•™ìŠµ ë°ì´í„°ê°€ ë§ì€ deep learningê³¼ ì˜¨ë¼ì¸ í•™ìŠµ(ë¯¸ë‹ˆë°°ì¹˜ ì´ìš©)ì— ì í•©í•˜ë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.linear_model </span><br><span class="line"><span class="keyword">import</span> SGDClassifier </span><br><span class="line">sgd_clf = SGDClassifier(random_state=<span class="number">42</span>) </span><br><span class="line">sgd_clf.fit(X_train, y_train_5) sgd_clf.predict([some_digit]) &gt;&gt;&gt; array([ <span class="literal">True</span>])</span><br></pre></td></tr></table></figure>
<p>SGDClassifier(random_state=42)ì—ì„œ random_stateì€ ë¬´ì‘ìœ„ ê°’ì„ ë„£ìœ¼ë©° ìµœì ê°’ì„ ì°¾ëŠ” SGDClassifierì˜ íŠ¹ì„±ì— ë”°ë¼, ì´ì „ì— ì‹¤í–‰í–ˆë˜ ê²°ê³¼ê°’ì„ repeatableí•˜ê²Œ ë°›ê¸° ìœ„í•´ íŠ¹ì •ê°’ì„ ì €ì¥í•˜ëŠ” ê²ƒì„ ì˜ë¯¸í•œë‹¤. ê°’ì˜ ì˜ë¯¸ëŠ” ë”±íˆ ì—†ìœ¼ë¯€ë¡œ, ì•„ë¬´ ì •ìˆ˜ë¡œ ì„¤ì •í•  ìˆ˜ ìˆë‹¤. ì´ í›„ classifierì— dataì™€ y_train_5ë¥¼ ë„£ì–´ classifierì„ fittingí•œë‹¤.</p>
<p>classifierì€ predictì˜ ê²°ê³¼ë¡œ some_digit(=X[0])ì„ ë„£ì—ˆì„ ë•Œ y_train_5ì— ë”°ë¼ 5 ì—¬ë¶€ë¥¼ ê°ì§€í•œ ê²°ê³¼ë¥¼ arrayì— ë‹´ëŠ”ë‹¤.</p>
<br />



<h2 id="3-3-ì„±ëŠ¥-ì¸¡ì •"><a href="#3-3-ì„±ëŠ¥-ì¸¡ì •" class="headerlink" title="3.3 ì„±ëŠ¥ ì¸¡ì •"></a>3.3 ì„±ëŠ¥ ì¸¡ì •</h2><h3 id="3-3-1-êµì°¨-ê²€ì¦ì„-ì‚¬ìš©í•œ-ì •í™•ë„-ì¸¡ì •"><a href="#3-3-1-êµì°¨-ê²€ì¦ì„-ì‚¬ìš©í•œ-ì •í™•ë„-ì¸¡ì •" class="headerlink" title="3.3.1 êµì°¨ ê²€ì¦ì„ ì‚¬ìš©í•œ ì •í™•ë„ ì¸¡ì •"></a>3.3.1 êµì°¨ ê²€ì¦ì„ ì‚¬ìš©í•œ ì •í™•ë„ ì¸¡ì •</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection </span><br><span class="line"><span class="keyword">import</span> StratifiedKFold </span><br><span class="line"><span class="keyword">from</span> sklearn.base </span><br><span class="line"><span class="keyword">import</span> clone skfolds = StratifiedKFold(n_splits=<span class="number">3</span>, random_state=<span class="number">42</span>) </span><br><span class="line"><span class="keyword">for</span> train_index, test_index <span class="keyword">in</span> skfolds.split(X_train, y_train_5) : </span><br><span class="line">	clone_clf = clone(sgd_clf) </span><br><span class="line">	X_train_folds = X_train[train_index] </span><br><span class="line">	y_train_folds = y_train_5[train_index] </span><br><span class="line">	X_test_fold = X_train[test_index] </span><br><span class="line">	y_test_fold = y_train[test_index] </span><br><span class="line">clone_clf.fit(X_train_folds, y_train_folds) </span><br><span class="line">y_pred = clone_clf.predict(X_test_fold) </span><br><span class="line">n_correct = <span class="built_in">sum</span>(y_pred == y_test_fold) </span><br><span class="line">print(n_correct / <span class="built_in">len</span>(y_pred)) &gt;&gt;&gt; <span class="number">0.9502</span>, <span class="number">0.96565</span>, <span class="number">0.96495</span></span><br></pre></td></tr></table></figure>
<p>StartifiedKFoldì—ì„œ n_splits=3ìœ¼ë¡œ ì„¤ì •í•˜ì˜€ìœ¼ë¯€ë¡œ, í´ë“œê°€ 3ê°œì¸ k-ê²¹ êµì°¨ ê²€ì¦ì´ ìˆ˜í–‰ëœë‹¤.</p>
<p>train/test_indexìœ¼ë¡œ skfolds ê°ì²´ì˜ split()ì„ í˜¸ì¶œí•˜ì—¬ í•™ìŠµìš©/ê²€ì¦ìš© ë°ì´í„°ë¡œ ë¶„í• í•  ìˆ˜ ìˆëŠ” ì¸ë±ìŠ¤ë¥¼ ë°˜í™˜ë°›ê³  ì‹¤ì œ ë¶„í• ëœ ë°ì´í„°ë¥¼ í•´ë‹¹ indexë¥¼ ëŒ€ì…í•˜ì—¬ ì¶”ì¶œí•œë‹¤. ì´ ë•Œ, split()ì˜ ëŒ€ìƒì€ X_train â†’ y_train_5 ì§‘í•©ì´ë‹¤. ì´ë¥¼ í† ëŒ€ë¡œ y ê°’ì˜ predictionì¸ y_predë¥¼ X_test_foldë¡œë¶€í„° predictí•˜ê³ , ì˜¬ë°”ë¥¸ ì˜ˆì¸¡ì˜ ìˆ˜ë¥¼ y_predì™€ y_test_foldë¥¼ ë¹„êµí•˜ì—¬ sum ê°’ì„ í†µí•´ ê³„ì‚°í•œë‹¤.</p>
<p>ìœ„ì˜ ê³¼ì •ì€ sklearnì˜ cross_val_scoreê³¼ ê±°ì˜ ê°™ì€ ê¸°ëŠ¥ì„ ë‚˜íƒ€ë‚´ë¯€ë¡œ ë‹¤ìŒê³¼ ê°™ì€ ì½”ë“œë¡œ ì •ë¦¬í•  ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> cross_val_score </span><br><span class="line">cross_val_score(sgd_clf, X_train, y_train_5, cv=<span class="number">3</span>, scoring=<span class="string">&quot;accuracy&quot;</span>) &gt;&gt;&gt; array([<span class="number">0.96355</span>, <span class="number">0.93795</span>, <span class="number">0.95615</span>])</span><br></pre></td></tr></table></figure>
<p>ì´ëŠ” ì•½ 95%ë¡œ êµ‰ì¥íˆ ë†’ì€ ì •í™•ë„ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. í•˜ì§€ë§Œ, ì´ëŸ¬í•œ ì •í™•ë„ë¥¼ ì„±ëŠ¥ ì¸¡ì • ì§€í‘œë¡œ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ” ì´ìœ ëŠ” ë‹¤ìŒê³¼ ê°™ë‹¤.</p>
<br />



<hr>
<p>ìœ„ì˜ ì˜ˆì‹œì™€ ë°˜ëŒ€ë¡œ, 5ê°€ ì•„ë‹Œ í´ë˜ìŠ¤ë¥¼ ë¶„ë¥˜í•˜ëŠ” ë”ë¯¸ ë¶„ë¥˜ê¸°ë¥¼ ë§Œë“¤ì–´ ì •í™•ë„ë¥¼ ë¹„êµí•´ë³¼ ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.base </span><br><span class="line"><span class="keyword">import</span> BaseEstimator </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Never5Classifier</span>(<span class="params">BaseEstimator</span>) :</span> </span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">fit</span>(<span class="params">self, X, y=<span class="literal">None</span></span>) :</span> </span><br><span class="line">		<span class="keyword">return</span> self </span><br><span class="line">		</span><br><span class="line">	<span class="function"><span class="keyword">def</span> <span class="title">predict</span>(<span class="params">self, X</span>) :</span> </span><br><span class="line">		<span class="keyword">return</span> np.zeros((<span class="built_in">len</span>(X), <span class="number">1</span>), dtype=<span class="built_in">bool</span>) </span><br><span class="line"></span><br><span class="line">never_5_clf = Never5Classifier() </span><br><span class="line">cross_val_score(never_5_clf, X_train, y_train_5, cv=<span class="number">3</span>, scoring=<span class="string">&quot;accuracy&quot;</span>) &gt;&gt;&gt; array([<span class="number">0.91125</span>, <span class="number">0.90855</span>, <span class="number">0.90915</span>])</span><br></pre></td></tr></table></figure>
<p>ì´ ë•Œ Never5Classifierì˜ predict í•¨ìˆ˜ëŠ” ë°°ì—´ì˜ ê²°ê³¼ë¥¼ ì „ë¶€ Falseë¡œ ì„¸íŒ…í•˜ì—¬ ë°°ì—´ì„ ë°˜í™˜í•œë‹¤.</p>
<p>í•´ë‹¹ classifierì„ cross_val_scoreì— ì ìš©í•  ì‹œ ì •í™•ë„ê°€ 90% ê°€ëŸ‰ ë‚˜ì˜¤ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤. ì´ëŠ” ì•½ 10%ì˜ ì´ë¯¸ì§€ê°€ ìˆ«ì 5ì´ë¯€ë¡œ ì´ë¥¼ ì œì™¸í•œ 90%ë¥¼ ì •í™•ë„ë¡œ ì¶œë ¥í•œë‹¤. ë”°ë¼ì„œ, ë¶ˆê· í˜•í•œ ë°ì´í„°ì…‹(5ì„/5ê°€ ì•„ë‹˜ = ì–´ë–¤ í´ë˜ìŠ¤ê°€ ë‹¤ë¥¸ ê²ƒë³´ë‹¤ ì›”ë“±íˆ ë§ìŒ)ì„ ë‹¤ë£° ë•ŒëŠ” ì •í™•ë„ë¥¼ ë¶„ë¥˜ê¸°ì˜ ì„±ëŠ¥ ì¸¡ì • ì§€í‘œë¡œ ì„ í˜¸í•˜ì§€ ì•ŠëŠ”ë‹¤.</p>
<br />



<h3 id="3-3-2-ì˜¤ì°¨-í–‰ë ¬"><a href="#3-3-2-ì˜¤ì°¨-í–‰ë ¬" class="headerlink" title="3.3.2 ì˜¤ì°¨ í–‰ë ¬"></a>3.3.2 ì˜¤ì°¨ í–‰ë ¬</h3><p>ì˜¤ì°¨ í–‰ë ¬ : ë°ì´í„°ì™€ ë‹¤ë¥¸ í´ë˜ìŠ¤ë¡œ ì˜ëª» ë¶„ë¥˜í•œ íšŸìˆ˜ë¥¼ ë‹´ì€ í–‰ë ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.model_selection </span><br><span class="line"><span class="keyword">import</span> cross_val_predict </span><br><span class="line">y_train_pred = cross_val_predict(sgd_clf, X_train, y_train_5, cv=<span class="number">3</span>)</span><br></pre></td></tr></table></figure>
<p><code>cross_val_score()</code> : í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ outputì˜ í‰ê· ì„ ì´ìš©í•´ í‰ê°€ ì ìˆ˜ ë°˜í™˜</p>
<p><code>cross_val_predict()</code> : í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ inputì˜ ê° elementì— ëŒ€í•œ ê¹¨ë—í•œ ì˜ˆì¸¡ ë°˜í™˜ (í›ˆë ¨í•˜ëŠ” ë™ì•ˆ ì‚¬ìš©ë˜ì§€ ì•Šì€ ë°ì´í„°ì— ëŒ€í•´ ì˜ˆì¸¡)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">confusion_matrix(y_train_5, y_train_pred) &gt;&gt;&gt; array([[<span class="number">53057</span>, <span class="number">1522</span>], [<span class="number">1325</span>, <span class="number">4096</span>]])</span><br></pre></td></tr></table></figure>
<ul>
<li>í–‰ : ì‹¤ì œ í´ë˜ìŠ¤ (ë°ì´í„°)</li>
<li>ì—´ : ì˜ˆì¸¡í•œ í´ë˜ìŠ¤</li>
</ul>
<p>ë”°ë¼ì„œ, ìœ„ì˜ ê²°ê³¼ì—ì„œ ì²« ë²ˆì§¸ í–‰ì´ â€œ5 ì•„ë‹˜â€(ìŒì„± í´ë˜ìŠ¤)ì¼ ë•Œ, ì²« ë²ˆì§¸ ì—´ì€ True Negative(ì˜ˆì¸¡ N, ì‹¤ì œ N)ì„ ë‚˜íƒ€ë‚´ë©°, ë‘ ë²ˆì§¸ ì—´ì€ False Positive(ì˜ˆì¸¡ P, ì‹¤ì œ N)ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤. ë‘ ë²ˆì§¸ í–‰ì€ â€œ5ì„â€(ì–‘ì„± í´ë˜ìŠ¤)ì´ë©°, ì²« ë²ˆì§¸ ì—´ì€ FN(ì˜ˆì¸¡ N, ì‹¤ì œ P), ë‘ ë²ˆì§¸ ì—´ì€ TP(ì˜ˆì¸¡ P, ì‹¤ì œ P)ì´ë‹¤.</p>
<hr>
<p>ì´ì— ì™„ë²½í•œ ë¶„ë¥˜ê¸°ëŠ” TPì™€ TNë§Œ ê°€ì§€ê³  ìˆì„ ê²ƒì´ë¯€ë¡œ, ì‹¤ì œ confusion matrixì˜ ì¶œë ¥ê°’ì€ ì£¼ëŒ€ê°ì„  ê°’ë§Œ ì¡´ì¬í•œë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">y_train_perfect_predictions = y_train_5 confusion_matrix(y_train_5, y_train_perfect_predictions) &gt;&gt;&gt; array([[<span class="number">54579</span>, <span class="number">0</span>], [<span class="number">0</span>, <span class="number">5421</span>]])</span><br></pre></td></tr></table></figure>
<br />



<h3 id="3-3-3-ì •ë°€ë„ì™€-ì¬í˜„ìœ¨"><a href="#3-3-3-ì •ë°€ë„ì™€-ì¬í˜„ìœ¨" class="headerlink" title="3.3.3 ì •ë°€ë„ì™€ ì¬í˜„ìœ¨"></a>3.3.3 ì •ë°€ë„ì™€ ì¬í˜„ìœ¨</h3><ul>
<li>ì •ë°€ë„ = ì •í™•ë„ = TP / (TP+FP)</li>
<li>ì¬í˜„ìœ¨ = ë¯¼ê°ë„ = TP / (TP+FN)</li>
</ul>
<p>ì •ë°€ë„ëŠ” ì˜ˆì¸¡ì´ ì–‘ì„±ì¸ ê²°ê³¼(TP, FP)ë¥¼, ì¬í˜„ìœ¨ì€ ì‹¤ì œ ì–‘ì„±ì¸ ê²°ê³¼(TP,FN)ë¥¼ ì´ìš©í•œë‹¤.</p>
<p>ì¦‰, ì •ë°€ë„ëŠ” í™•ì‹¤í•œ ì–‘ì„± ìƒ˜í”Œ í•˜ë‚˜ë§Œ ì˜ˆì¸¡í•  ì‹œ 1ì´ ë‚˜ì˜¤ì§€ë§Œ ì´ëŠ” ë‹¤ë¥¸ ëª¨ë“  ì–‘ì„± ìƒ˜í”Œì„ ë¬´ì‹œí•œ ê²°ê³¼ì´ë¯€ë¡œ, ì¬í˜„ìœ¨(ë¯¼ê°ë„ ë˜ëŠ” ì§„ì§œ ì–‘ì„± ë¹„ìœ¨)ê³¼ ê°™ì€ ë‹¤ë¥¸ ì§€í‘œì™€ í•¨ê»˜ ì‚¬ìš©í•´ì•¼ í•œë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">precision_score(y_train_5, y_train_pred) // ì •ë°€ë„ &gt;&gt;&gt; <span class="number">0.729085</span>... </span><br><span class="line">recall_score(y_train_5, y_train_pred) // ì¬í˜„ìœ¨ &gt;&gt;&gt; <span class="number">0.755580</span>...</span><br></pre></td></tr></table></figure>
<p>0.729ëŠ” ì •ë°€ë„ë¡œ, 5ë¡œ íŒë³„ëœ ì´ë¯¸ì§€ ì¤‘ 72.9%ê°€ ì •í™•í•˜ë‹¤ëŠ” ì˜ë¯¸ì´ë©°, 0.756ì€ ì¬í˜„ìœ¨ìœ¼ë¡œ, ì „ì²´ ìˆ«ì 5ì—ì„œ 75.6%ì˜ 5ë§Œ ê°ì§€í•œ ê²ƒì„ ì˜ë¯¸í•œë‹¤.</p>
<br />

<hr>
<p>ì´ë¥¼ í•˜ë‚˜ì˜ ìˆ«ìë¡œ í†µí•©í•´ ì‚´í´ë³¼ ìˆ˜ ìˆëŠ” í‰ê°€ ì§€í‘œê°€ F1 ì ìˆ˜, ì¦‰ ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì˜ ì¡°í™” í‰ê· ì´ë‹¤.</p>
<ul>
<li>F1 = TP / (TP + (FN + FP) / 2)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">f1_score(y_train_5, y_train_pred) &gt;&gt;&gt; <span class="number">0.742096</span>...</span><br></pre></td></tr></table></figure>
<p>ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì´ ë¹„ìŠ·í•  ì‹œ F1ì˜ ê°’ì´ ë†’ê²Œ ë‚˜ì˜¤ë¯€ë¡œ ê°„ë‹¨í•œ í‰ê°€ ì§€í‘œë¡œ ì´ìš©í•  ìˆ˜ ìˆì§€ë§Œ,</p>
<p>ì •ë°€ë„/ì¬í˜„ìœ¨ íŠ¸ë ˆì´ë“œì˜¤í”„ì— ë”°ë¼ ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì´ ë°˜ë¹„ë¡€í•˜ëŠ” ê²½ìš° ìƒí™©ì— ë”°ë¼ ë‘˜ì˜ ì¤‘ìš”ì„±ì´ ë‹¬ë¼ì§€ë¯€ë¡œ F1ì„ ì£¼ìš” í‰ê°€ ì§€í‘œë¡œ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ë°”ëŒì§í•˜ì§€ ì•Šë‹¤.</p>
<br />



<h3 id="3-3-4-ì •ë°€ë„-ì¬í˜„ìœ¨-íŠ¸ë ˆì´ë“œì˜¤í”„"><a href="#3-3-4-ì •ë°€ë„-ì¬í˜„ìœ¨-íŠ¸ë ˆì´ë“œì˜¤í”„" class="headerlink" title="3.3.4 ì •ë°€ë„/ì¬í˜„ìœ¨ íŠ¸ë ˆì´ë“œì˜¤í”„"></a>3.3.4 ì •ë°€ë„/ì¬í˜„ìœ¨ íŠ¸ë ˆì´ë“œì˜¤í”„</h3><p>ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì€ ê²°ì • í•¨ìˆ˜ì˜ ê²°ê³¼ë¡œ ë‚˜ì˜¨ output datasetì— ì ìš©í•˜ëŠ” ì„ê³—ê°’ì— ë”°ë¼ ë‹¬ë¼ì§„ë‹¤.</p>
<p>ì¦‰, ì„ê³—ê°’ì„ ë†’ê²Œ ì„¤ì •í•  ê²½ìš° ì •ë°€ë„ëŠ” ë†’ì•„ì§€ë‚˜ í¬í•¨ë˜ëŠ” TPê°€ ë‚®ì•„ì§€ë¯€ë¡œ ì¬í˜„ìœ¨ì€ ë–¨ì–´ì§€ë©°, ì„ê³—ê°’ì„ ë‚®ê²Œ ì„¤ì •í•  ê²½ìš° ì •ë°€ë„ëŠ” ë–¨ì–´ì§€ë‚˜ ì¬í˜„ìœ¨ì€ ë†’ì•„ì§„ë‹¤. some_digitì˜ ì˜ˆì¸¡ì— ì‚¬ìš©í•œ ì ìˆ˜ë¥¼ í™•ì¸í•˜ê³  ì„ê³—ê°’ì„ ì •í•´ ì–‘ì„±/ìŒì„± ì˜ˆì¸¡ì„ ë§Œë“¤ê¸° ìœ„í•´ decision_function()ì„ ì´ìš©í•œë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">y_scores = sgd_clf.decision_function([some_digit]) </span><br><span class="line">y_scores &gt;&gt;&gt; array([<span class="number">2412.53175101</span>]) </span><br><span class="line">threshold = <span class="number">0</span> </span><br><span class="line">y_some_digit_pred = (y_scores &gt; threshold) &gt;&gt;&gt; array([ <span class="literal">True</span>]) </span><br><span class="line">threshold = <span class="number">8000</span> </span><br><span class="line">y_some_digit_pred = (y_scores &gt; threshold) y_some_digit_[red &gt;&gt;&gt; array([<span class="literal">False</span>])</span><br></pre></td></tr></table></figure>
<p>ë”°ë¼ì„œ ì ì ˆí•œ ì„ê³—ê°’ì„ ì„¤ì •í•˜ê¸° ìœ„í•˜ì—¬, cross_val_predict()ì˜ decision_functionì„ ì´ìš©í•˜ì—¬ ëª¨ë“  ìƒ˜í”Œì˜ ê²°ì • ì ìˆ˜ë¥¼ ì–»ëŠ”ë‹¤. ì´í›„ precision_recall_curve()ë¥¼ ì´ìš©í•´ ê°€ëŠ¥í•œ ì„ê³—ê°’ì— ëŒ€í•œ ì •ë°€ë„ì™€ ì¬í˜„ìœ¨ì„ ì–»ëŠ”ë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">y_scores = cross_val_predict(sgd_clf, X_train, y_train_5, cv=<span class="number">3</span>, method=<span class="string">&quot;decision_function&quot;</span>) </span><br><span class="line">precisions, recalls, thresholds = precision_recall_curve(y_train_5, y_scores)</span><br></pre></td></tr></table></figure>
<p>ì¢‹ì€ ì •ë°€ë„/ì¬í˜„ìœ¨ íŠ¸ë ˆì´ë“œì˜¤í”„ëŠ” ì¬í˜„ìœ¨ì— ëŒ€í•œ ì •ë°€ë„ ê³¡ì„ ì—ì„œ ì •ë°€ë„ê°€ ê¸‰ê²©í•˜ê²Œ ì¤„ì–´ë“œëŠ” ì§€ì  ì§ì „ì˜ ê°’ìœ¼ë¡œ ì„ê³—ê°’ì„ ì„¤ì •í•˜ë©´ ëœë‹¤.</p>
<p>ë˜í•œ íŠ¹ì •í•œ ëª©í‘œì¹˜ì˜ ì •ë°€ë„ë¥¼ ë‹¬ì„±í•˜ëŠ” ê²ƒì´ ëª©í‘œ(n%ë¼ê³  ê°€ì •í•´ë³´ì.)ì¼ ë•ŒëŠ”, ë‹¤ìŒê³¼ ê°™ì´ ì„ê³—ê°’ì„ ì„¤ì •í•˜ë©´ ëœë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">threshold_90_precision = thresholds[np.argmax(precisions &gt;= n / <span class="number">100</span>)] </span><br><span class="line">y_train_pred_90 = (y_scores &gt;= threshold_90_precision) </span><br><span class="line">precision_score(y_train_5, y_train_pred_90) &gt;&gt;&gt; <span class="number">0.900038</span>... </span><br><span class="line">recall_score(y_train_5, y_train_pred_90) &gt;&gt;&gt; <span class="number">0.436819</span>...</span><br></pre></td></tr></table></figure>
<p>í•˜ì§€ë§Œ ì¬í˜„ìœ¨ì´ ë„ˆë¬´ ë‚®ì„ ê²½ìš°, ë†’ì€ ì •ë°€ë„ì˜ ë¶„ë¥˜ê¸°ëŠ” ìœ ìš©í•˜ì§€ ì•Šë‹¤.</p>
<br />



<h3 id="3-3-5-ROC-ê³¡ì„ "><a href="#3-3-5-ROC-ê³¡ì„ " class="headerlink" title="3.3.5 ROC ê³¡ì„ "></a>3.3.5 ROC ê³¡ì„ </h3><p>ROC ê³¡ì„  : ê±°ì§“ ì–‘ì„± ë¹„ìœ¨(FPR)ì— ëŒ€í•œ ì§„ì§œ ì–‘ì„± ë¹„ìœ¨(TPR, ì¬í˜„ìœ¨)ì˜ ê³¡ì„ ìœ¼ë¡œ, FPR = 1(ì‹¤ì œ ìŒì„±) - TNRì´ë‹¤. ì´ ë•Œ TNRì„ íŠ¹ì´ë„ë¼ê³  í•˜ë©°, ROCë¥¼ ì¬í˜„ìœ¨ì— ëŒ€í•œ 1-íŠ¹ì´ë„ë¼ê³  í•œë‹¤.</p>
<p>TPRê³¼ FPRì„ ê³„ì‚°í•˜ê¸° ìœ„í•´ ì‚¬ìš©ë˜ëŠ” í•¨ìˆ˜ëŠ” roc_curve()ë¡œ, ë‹¤ìŒê³¼ ê°™ì´ ì‚¬ìš©ëœë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">fpr, tpr, thresholds = roc_curve(y_train_5, y_scores)</span><br></pre></td></tr></table></figure>
<p>TPRì´ ë†’ì•„ì§ˆ ìˆ˜ë¡ FPRë„ ë†’ì•„ì§€ë¯€ë¡œ, ì¢‹ì€ ë¶„ë¥˜ê¸°ëŠ” ì™„ì „í•œ ëœë¤ ë¶„ë¥˜ê¸°(TPR : FPR = 1 : 1)ì—ì„œ ìµœëŒ€í•œ ì™¼ìª½ ìœ„ ëª¨ì„œë¦¬(TPRì€ ë†’ê³  FPRì€ ë‚®ì€)ë¡œ ë©€ë¦¬ ë–¨ì–´ì ¸ì•¼ í•œë‹¤. ì´ë¥¼ í‰ê°€í•˜ëŠ” ì§€í‘œë¡œëŠ” ê³¡ì„  ì•„ë˜ì˜ ë©´ì (AUC)ê°€ ìˆëŠ”ë°, AUCë¥¼ ê³„ì‚°í•˜ê¸° ìœ„í•´ RandomForestClassifierì„ ì´ìš©í•œë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.ensemble <span class="keyword">import</span> RandomForestClassifier </span><br><span class="line">forest_clf = RandomForestClassifier(random_state = <span class="number">42</span>) </span><br><span class="line">y_probas_forest = cross_val_predict(forest_clf, X_train, y_train_5, cv=<span class="number">3</span>, method=<span class="string">&quot;predict_proba&quot;</span>) </span><br><span class="line">y_scores_forest = y_probas_forest[:, <span class="number">1</span>] </span><br><span class="line">roc_auc_score(y_train_5, y_scores_forest)</span><br></pre></td></tr></table></figure>
<p>RandomForestClassifierì—ì„œëŠ” decision_function ëŒ€ì‹  predict_proba ê¸°ëŠ¥ì„ ì œê³µí•œë‹¤.</p>
<p>ê·¸ ê²°ê³¼ë¡œì„œ, RandomForestClassifierëŠ” SGDClassifierë³´ë‹¤ ì™¼ìª½ ìœ„ ëª¨ì„œë¦¬ì— ë” ê°€ê¹Œìš´ ROC ê³¡ì„ ì„ ìƒì„±í•˜ë¯€ë¡œ AUC ì ìˆ˜ë¡œ ë” ë†’ë‹¤.</p>
<br />



<h2 id="3-4-ë‹¤ì¤‘-ë¶„ë¥˜"><a href="#3-4-ë‹¤ì¤‘-ë¶„ë¥˜" class="headerlink" title="3.4 ë‹¤ì¤‘ ë¶„ë¥˜"></a>3.4 ë‹¤ì¤‘ ë¶„ë¥˜</h2><p>ë‹¤ì¤‘ ë¶„ë¥˜ê¸°ë¡œ ë‘˜ ì´ìƒì˜ í´ë˜ìŠ¤ë¥¼ êµ¬ë³„í•  ìˆ˜ ìˆìœ¼ë‚˜, ë³´í†µ ì´ì§„ ë¶„ë¥˜ê¸°ë¥¼ ì´ìš©í•´ ë‹¤ìŒê³¼ ê°™ì€ 2ê°€ì§€ì˜ ë°©ë²•ìœ¼ë¡œ ë‹¤ì¤‘ í´ë˜ìŠ¤ë¥¼ êµ¬ë³„í•œë‹¤. ë³´í†µ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ ì‘ì—…ì— ì´ì§„ ë¶„ë¥˜ ì•Œê³ ë¦¬ì¦˜ì„ ì„ íƒí•˜ë©´ ìë™ì ìœ¼ë¡œ OvRì´ë‚˜ OvOë¥¼ ì‹¤í–‰í•˜ì§€ë§Œ, importë¥¼ í†µí•´ í´ë˜ìŠ¤ ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ê°•ì œì ìœ¼ë¡œ ì›í•˜ëŠ” Classifierì„ ì„¤ì •í•  ìˆ˜ë„ ìˆë‹¤.</p>
<ul>
<li>OvR(OvA) : íŠ¹ì • í´ë˜ìŠ¤ë§Œ êµ¬ë¶„í•˜ëŠ” í´ë˜ìŠ¤ë³„ ì´ì§„ ë¶„ë¥˜ê¸° nê°œë¥¼ í›ˆë ¨ì‹œì¼œ í´ë˜ìŠ¤ê°€ nê°œì˜ í´ë˜ìŠ¤ ë¶„ë¥˜ ì‹œìŠ¤í…œì„ ë§Œë“ ë‹¤. ì´í›„ ê° ë¶„ë¥˜ê¸°ì˜ ê²°ì • ì ìˆ˜ ì¤‘ì—ì„œ ê°€ì¥ ë†’ì€ ê²ƒì„ í´ë˜ìŠ¤ë¡œ ì„ íƒí•œë‹¤. ì´ëŠ” í° í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ì ì€ ë¶„ë¥˜ê¸°ë¥¼ í›ˆë ¨ì‹œí‚¨ë‹¤.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.multiclass <span class="keyword">import</span> OneVsRestClassifier</span><br></pre></td></tr></table></figure>
<ul>
<li>OvO : ê° í´ë˜ìŠ¤ì˜ ì¡°í•©ë§ˆë‹¤ ì´ì§„ ë¶„ë¥˜ê¸°ë¥¼ í›ˆë ¨ì‹œí‚¨ë‹¤. ì´ ì¤‘ ê°€ì¥ ë§ì´ ì–‘ì„±ìœ¼ë¡œ ë¶„ë¥˜ëœ í´ë˜ìŠ¤ë¥¼ ì„ íƒí•œë‹¤. ì´ëŠ” ê° ë¶„ë¥˜ê¸°ì˜ í›ˆë ¨ì— ì „ì²´ í›ˆë ¨ ì„¸íŠ¸ ì¤‘ êµ¬ë³„í•  ë‘ í´ë˜ìŠ¤ì˜ ìƒ˜í”Œë§Œ í•„ìš”í•˜ë¯€ë¡œ, ì‘ì€ í›ˆë ¨ ì„¸íŠ¸ì—ì„œ ë§ì€ ë¶„ë¥˜ê¸°ë¥¼ í›ˆë ¨ì‹œí‚¬ ìˆ˜ ìˆë‹¤.</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.multiclass <span class="keyword">import</span> OneVsOneClassifier</span><br></pre></td></tr></table></figure>
<p>ë” ë†’ì€ ì •í™•ë„ë¥¼ ìœ„í•´, ì…ë ¥ì˜ ìŠ¤ì¼€ì¼ì„ ì¡°ì •í•˜ë©´ ë¶„ë¥˜ê¸°ì˜ ì„±ëŠ¥ì„ ë†’ì¼ ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sklearn.preprocessing <span class="keyword">import</span> StandartScaler </span><br><span class="line">scaler = StandardScaler() </span><br><span class="line">X_train_scaled = scaler.fit_transform(X_train.astype(float64))</span><br></pre></td></tr></table></figure>
<br />



<h2 id="3-5-ì—ëŸ¬-ë¶„ì„"><a href="#3-5-ì—ëŸ¬-ë¶„ì„" class="headerlink" title="3.5 ì—ëŸ¬ ë¶„ì„"></a>3.5 ì—ëŸ¬ ë¶„ì„</h2><p>cross_val_predict()ë¥¼ ì´ìš©í•´ ê²°ê³¼ê°’ì„ ì˜ˆì¸¡í•˜ê³ , ì´ í›„ confusion_matrix()ë¥¼ ì´ìš©í•´ ì˜¤ì°¨ í–‰ë ¬ì„ ìƒì„±í•œë‹¤. ê·¸ í›„ matshow()ë¥¼ ì‹¤í–‰ ì‹œ, ê° í´ë˜ìŠ¤ ë³„ë¡œ ì˜ˆì¸¡í•œ í´ë˜ìŠ¤ì˜ í™•ë¥ ì´ ë°ê¸°ë¡œ ë‚˜íƒ€ë‚˜ëŠ”ë°, ë°ì„ ìˆ˜ë¡ ë†’ì€ í™•ë¥ ì„ ë‚˜íƒ€ë‚¸ë‹¤. ë”°ë¼ì„œ ì˜¬ë°”ë¥¸ ì˜¤ì°¨ í–‰ë ¬ì€ ì£¼ëŒ€ê°ì„ ì˜ ë°ê¸°ê°€ ë°ê³ , ë‚˜ë¨¸ì§€ëŠ” ì–´ë‘ì›Œì•¼ í•œë‹¤.</p>
<p>ì´ëŸ¬í•œ ì˜¤ì°¨ í–‰ë ¬ì˜ íŠ¹ì„±ì— ë”°ë¼ ì˜ëª» ë¶„ë¥˜ëœ í´ë˜ìŠ¤ë¥¼ íŒŒì•…í•˜ê³  ë¶„ë¥˜ê¸°ì˜ ì„±ëŠ¥ í–¥ìƒ ë°©ì•ˆì— ëŒ€í•´ ìƒê°í•´ë³¼ ìˆ˜ ìˆë‹¤. íŠ¹íˆ ì´ ê³¼ì •ì—ì„œ ë°ì´í„°ì˜ ì „ì²˜ë¦¬ê°€ ì¤‘ìš”í•œë°, 3ê³¼ 5ì˜ í´ë˜ìŠ¤ë¥¼ ë¶„ë¥˜í•˜ëŠ” ì˜ˆì‹œì˜ ê²½ìš° SGDClassifierì„ ì ìš©í•  ê²½ìš° ë¯¸ì„¸í•œ í”½ì…€ ê°•ë„ì˜ ì°¨ì´ê°€ í´ë˜ìŠ¤ ë¶„ë¥˜ì˜ ì˜¤ë¥˜ë¡œ ì´ì–´ì§€ë¯€ë¡œ ì´ë¯¸ì§€ì˜ íšŒì „ê°’ì„ 0ìœ¼ë¡œ ì¡°ì •í•˜ëŠ” ê²ƒì´ ì´ì— í•´ë‹¹í•œë‹¤.</p>
<br />



<h2 id="3-6-ë‹¤ì¤‘-ë ˆì´ë¸”-ë¶„ë¥˜"><a href="#3-6-ë‹¤ì¤‘-ë ˆì´ë¸”-ë¶„ë¥˜" class="headerlink" title="3.6 ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜"></a>3.6 ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜</h2><p>ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜ ì‹œìŠ¤í…œ : í•˜ë‚˜ì˜ ìƒ˜í”Œì— ì—¬ëŸ¬ ê°œì˜ í´ë˜ìŠ¤ê°€ í¬í•¨ë  ê²½ìš°, ë ˆì´ë¸”ì„ ë‹¬ì•„ ê° í´ë˜ìŠ¤ë¥¼ êµ¬ë³„í•˜ëŠ” ì‹œìŠ¤í…œ</p>
<p>ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜ ì‹œ ì ì ˆí•œ ì§€í‘œë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•œë°, ë‹¤ìŒê³¼ ê°™ì´ F1 ì ìˆ˜ì— ë‹¤ë¥¸ ê°€ì¤‘ì¹˜ ê¸°ì¤€ì„ ì ìš©í•˜ì—¬ ë¶„ë¥˜ê¸°ë¥¼ í‰ê°€í•  ìˆ˜ ìˆë‹¤.</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">y_train_knn_pred = cross_val_predict(knn_clf, X_train, y_multilabel, cv=<span class="number">3</span>) </span><br><span class="line">f1_score(y_multilabel, y_train_knn_pred, average = <span class="string">&quot;macro&quot;</span>) <span class="comment"># ëª¨ë“  ë ˆì´ë¸”ì˜ ê°€ì¤‘ì¹˜ê°€ ê°™ìŒ </span></span><br><span class="line">f1_score(y_multilabel, y_train_knn_pred, average = <span class="string">&quot;weighted&quot;</span>) <span class="comment"># íƒ€ê¹ƒ ë ˆì´ë¸”ì— ì†í•œ ìƒ˜í”Œ ìˆ˜(ì§€ì§€ë„)ì— ê°€ì¤‘ì¹˜ë¥¼ ë‘ </span></span><br></pre></td></tr></table></figure>
<br />



<h2 id="3-7-ë‹¤ì¤‘-ì¶œë ¥-ë¶„ë¥˜"><a href="#3-7-ë‹¤ì¤‘-ì¶œë ¥-ë¶„ë¥˜" class="headerlink" title="3.7 ë‹¤ì¤‘ ì¶œë ¥ ë¶„ë¥˜"></a>3.7 ë‹¤ì¤‘ ì¶œë ¥ ë¶„ë¥˜</h2><p>ë‹¤ì¤‘ ì¶œë ¥ ë¶„ë¥˜(ë‹¤ì¤‘ ì¶œë ¥ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜) ì‹œìŠ¤í…œ : ë‹¤ì¤‘ ë ˆì´ë¸” ë¶„ë¥˜ì—ì„œ ê° ë ˆì´ë¸”ì´ ë‹¤ì¤‘ í´ë˜ìŠ¤ê°€ ë  ìˆ˜ ìˆë„ë¡ ì¼ë°˜í™”í•œ ì‹œìŠ¤í…œ</p>
<p>ì´ë¥¼ ì¡ìŒì´ í¬í•¨ëœ ì´ë¯¸ì§€ë¥¼ ì˜ˆì‹œë¡œ ì„¤ëª…í•´ë³´ìë©´, ì¡ìŒì´ í¬í•¨ëœ ì´ë¯¸ì§€ì˜ ê° í”½ì…€ì€ í•˜ë‚˜ì˜ ë ˆì´ë¸”ì— í•´ë‹¹ë˜ë©° ëª¨ë“  í”½ì…€ì€ 0~255ì˜ ë‹¤ì–‘í•œ ê°’ì„ ê°€ì§ˆ ìˆ˜ ìˆë‹¤. í•´ë‹¹ ì´ë¯¸ì§€ì—ì„œ ì¡ìŒì„ ì œê±° ì‹œ ê° í”½ì…€ì˜ ê°’ì€ ë³€í™”í•˜ë¯€ë¡œ ë‹¤ì¤‘ í´ë˜ìŠ¤ê°€ ë  ìˆ˜ ìˆë‹¤. ë”°ë¼ì„œ ì´ëŠ” ë‹¤ì¤‘ ë ˆì´ë¸”ì— ë‹¤ì¤‘ í´ë˜ìŠ¤ê°€ í•©ì³ì§„ ë‹¤ì¤‘ ì¶œë ¥ ë‹¤ì¤‘ í´ë˜ìŠ¤ ë¶„ë¥˜ì´ë‹¤.</p>

            


        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-none-link" href="/tags/Hands-On-Machine-Learning/" rel="tag">Hands-On Machine Learning</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Keras/" rel="tag">Keras</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/Tensorflow/" rel="tag">Tensorflow</a> <a class="tag tag--primary tag--small t-none-link" href="/tags/machine-learning/" rel="tag">machine learning</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/05/26/basic-Python/"
                    data-tooltip="basic Python"
                    aria-label="PREVIOUS: basic Python"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/05/22/Data2Vis-code-review/"
                    data-tooltip="Data2Vis ì½”ë“œ ë¦¬ë·°"
                    aria-label="NEXT: Data2Vis ì½”ë“œ ë¦¬ë·°"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2021 JungHyun. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="5">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/05/26/basic-Python/"
                    data-tooltip="basic Python"
                    aria-label="PREVIOUS: basic Python"
                >
                    
                        <i class="fa fa-angle-left" aria-hidden="true"></i>
                        <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                    </a>
            </li>
            <li class="post-action">
                
                    
                <a
                    class="post-action-btn btn btn--default tooltip--top"
                    href="/2021/05/22/Data2Vis-code-review/"
                    data-tooltip="Data2Vis ì½”ë“œ ë¦¬ë·°"
                    aria-label="NEXT: Data2Vis ì½”ë“œ ë¦¬ë·°"
                >
                    
                        <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                        <i class="fa fa-angle-right" aria-hidden="true"></i>
                    </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a
                class="post-action-btn btn btn--default btn-open-shareoptions"
                href="#btn-open-shareoptions"
                aria-label="Share this post"
            >
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://www.facebook.com/sharer/sharer.php?u=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                    title="Share on Facebook"
                    aria-label="Share on Facebook"
                >
                    <i class="fab fa-facebook" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://twitter.com/intent/tweet?text=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                    title="Share on Twitter"
                    aria-label="Share on Twitter"
                >
                    <i class="fab fa-twitter" aria-hidden="true"></i>
                </a>
            </li>
        
            
            
            <li class="post-action hide-xs">
                <a
                    class="post-action-btn btn btn--default"
                    target="new" href="https://plus.google.com/share?url=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                    title="Share on Google+"
                    aria-label="Share on Google+"
                >
                    <i class="fab fa-google-plus" aria-hidden="true"></i>
                </a>
            </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                
    <div id="share-options-bar" class="share-options-bar" data-behavior="5">
        <i id="btn-close-shareoptions" class="fa fa-times"></i>
        <ul class="share-options">
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://www.facebook.com/sharer/sharer.php?u=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                        aria-label="Share on Facebook"
                    >
                        <i class="fab fa-facebook" aria-hidden="true"></i><span>Share on Facebook</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://twitter.com/intent/tweet?text=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                        aria-label="Share on Twitter"
                    >
                        <i class="fab fa-twitter" aria-hidden="true"></i><span>Share on Twitter</span>
                    </a>
                </li>
            
                
                
                <li class="share-option">
                    <a
                        class="share-option-btn"
                        target="new"
                        href="https://plus.google.com/share?url=https://leahincom.github.io/2021/05/24/HandsonML-ch3/"
                        aria-label="Share on Google+"
                    >
                        <i class="fab fa-google-plus" aria-hidden="true"></i><span>Share on Google+</span>
                    </a>
                </li>
            
        </ul>
    </div>


            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-times"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/profile.jpeg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">JungHyun</h4>
        
            <div id="about-card-bio"><p>author.bio</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>author.job</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker-alt"></i>
                <br/>
                Seoul/South Korea, London/UK
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/IMG_5960.jpeg');"></div>
        <!--SCRIPTS-->

<script src="/assets/js/jquery.js"></script>


<script src="/assets/js/jquery.fancybox.js"></script>


<script src="/assets/js/thumbs.js"></script>


<script src="/assets/js/tranquilpeak.js"></script>

<!--SCRIPTS END-->


    




    </body>
</html>
